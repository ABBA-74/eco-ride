name: Test DockerHub connection

on:
  workflow_dispatch: # exÃ©cution manuelle

jobs:
  test-dockerhub:
    runs-on: ubuntu-latest

    steps:
      - name: ğŸ”‘ Log in to Docker Hub
        uses: docker/login-action@v3
        with:
          username: ${{ secrets.DOCKERHUB_USERNAME }}
          password: ${{ secrets.DOCKERHUB_TOKEN }}

      - name: ğŸ§ª Verify connection
        run: |
          echo "âœ… Successfully logged in to Docker Hub as ${{ secrets.DOCKERHUB_USERNAME }}"
          echo "ğŸ” Listing repositories:"
          curl -s -u "${{ secrets.DOCKERHUB_USERNAME }}:${{ secrets.DOCKERHUB_TOKEN }}" \
            https://hub.docker.com/v2/repositories/${{ secrets.DOCKERHUB_USERNAME }}/?page_size=5 \
            | jq '.results[].name' || echo "âš ï¸ Could not list repositories (check jq installation)"

      - name: ğŸ”’ Log out from Docker Hub
        run: docker logout
